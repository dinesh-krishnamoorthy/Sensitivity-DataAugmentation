function [Y,Xf,Af] = ApproxMPC_Aug(X,~,~)
%APPROXMPC_AUG neural network simulation function.
%
% Auto-generated by MATLAB, 17-Mar-2021 00:55:52.
% 
% [Y] = ApproxMPC_Aug(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 2xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.0632;0.528630994152047];
x1_step1.gain = [5;6.18679787984587];
x1_step1.ymin = -1;

% Layer 1
b1 = [3.5585929017746642522;2.7868435350602283052;-3.5265818312806533896;2.6042371013092071586;-0.74321830466944471816;0.026865668893773144571;1.508606682200006599;4.7730863303214521309;-3.7740137079301181444;4.3371370756853879769];
IW1_1 = [-5.6263574737197998843 -3.5681928633431376774;-2.3209467596982173987 -4.1318678324750193198;4.4607486691130278089 3.2829661525814466394;-1.6910676164837226132 -7.2344586793858907114;-0.032527346757466435445 -1.4442526217882605266;4.0523261007661268707 4.9901028721896976137;4.0459276505737324925 5.0173490851822570846;3.6362019341444611342 1.873917226454596463;-6.1625631191359033778 4.2327662166650119602;0.99991439655901359629 -4.4469367728639790371];

% Layer 2
b2 = [1.3495622189736640184;1.029911356536260536;1.1487220613902544564;0.19019961231367105148;0.534119415865754954;0.19105937303292205853;-0.92197806920133273945;1.663320554501602988;-0.96520272321713562746;1.9811006321841257982];
LW2_1 = [0.19056470187113991321 0.51422122515124002451 0.63782954611374809151 0.32097456491584941407 1.3320102313616291045 0.61808876622012820512 -1.7566256192723386231 -2.0937431280760976371 -2.4518582783085922649 0.32231274183030156344;-0.074078247859874338244 0.38808857176654515397 -0.032353187959890075676 -3.1564132253864798372 -0.91457831924062804596 1.1182012147485214104 -0.66530130797916164909 0.18354173913725310707 1.4622851643504368724 0.63618731636222236592;-0.14753067718966672572 0.42070620403380931673 -0.48916212632229610913 -1.6418811264384955972 1.0535287762749736551 1.1197533773546080038 0.56275079199284450127 -0.87875498984536948299 -1.1519803529272958365 0.79500415647946676145;-0.13985853623390812062 0.56886825973065457962 -0.12562572370555072365 -0.67182739847321526483 -0.098051505713329767389 -0.65833996571842956502 -0.27869251389328014712 -0.29456956258376160163 0.51499844788631521375 0.53619968681228091789;-0.24938468121972970359 0.3856773359664016354 1.5936889672896090708 0.3450878718585801419 -0.96603595668234887306 -0.27748964122748281946 -1.2893219847785244436 -1.4810775254102817033 1.5037385640989433533 -0.12018236682209292032;1.4979863882588269064 -0.0025355584474785171703 1.2326988178088396086 -0.77796283478794858723 -2.7410620885332610541 0.78354986194667330945 -0.11220207706263940484 0.55623910672603427141 -0.047431014381950020731 -0.52989312557122358882;-1.6897948926441863637 -0.56086482148959548866 1.1707541098294589332 0.25257048634676215748 1.6307615178930963129 -0.67879007808924174405 -1.6432621062225678532 -0.03589726710984591368 2.6202268339333567582 0.23373992788927125397;1.4263980334816301898 -0.7500775490608684315 -0.43931519093624032957 0.43274647636883667445 0.49813071778927114908 0.47126262209598734909 -0.44582608305247178881 0.60022638475863965279 -0.52982818493623529132 -0.11316385180681591549;1.4709200001617890319 0.27364170305477508727 1.0150412600235103611 0.055745636379877575028 3.8410179983304577611 0.52995400169864814721 -0.23864390732850063181 -0.10801295474175554023 -0.20416645497939220344 0.16170958909804949988;0.535677580407907028 0.88772898927104271216 -0.016871622079082996409 0.037379205184143046714 -0.45198363475385716637 0.88844612052935401092 -0.51186615246259803413 0.44793676120022113407 0.17954620670148715988 0.56090648265717069076];

% Layer 3
b3 = [0.73131785329937670781;-0.4860860965312635007;-1.3759823824986163743;-0.5098341983800580568;0.17188437627588809553;-0.23867005150974210381;0.13573023851268664619;-1.3382967742980576009;-2.316745784588778001;1.9457372086787794174];
LW3_2 = [0.2735238873504498569 -2.4690865142212956584 0.53184666089522869559 -0.085633045616456071603 1.498895616742407455 -0.67009277801147992815 0.88692931795624452285 -0.41085055993140051633 -0.56594160109753621768 -0.9407830190956143479;0.18541603455633334785 -0.98783718296782574431 -0.48116992865534580215 0.23095553199264104438 0.32667436260798843328 0.83554779432591008703 -0.20943504761464151742 1.2238077062390226857 1.7714926593571804769 0.47952193327412917512;1.0049279221199363121 -2.4856818184787159431 0.1036810322098215692 -2.1811184853375999992 -0.091887491878348909191 -1.0379292788236442746 -0.033277751274867491127 0.88318308644388721085 1.1562373998222401639 -1.1451648614538094684;0.75156205386096763821 0.52541326364485740896 1.4892633755159674358 0.71957468386237810609 0.012093745877125370095 -0.56673327587889898993 -0.4560576033450506328 1.1025353287388064416 0.58730033864714059622 0.70239624092932573252;1.9289068447531565464 -2.2059066059943623905 3.0400604064136662608 3.0647737968715591528 2.9018007361478970196 0.29039854585852331592 0.054750683236813209309 1.1795223451231380274 2.5383063959613103577 1.0402444522740212918;-0.16111644914127817851 -0.50934966126934666519 -0.77725854918984293995 -0.11246269569391645349 -0.40770426409868304463 2.0831165146398249455 0.25499903885099844958 0.57779687318128536422 -1.5505755264749752076 0.6651986022248381758;-0.33079245579641530783 -0.83352441703334489986 -1.0963998109277039994 -0.15618400524023201559 0.87300313552022068553 -0.2567782956395565086 1.0800809835486080424 0.39743979821558689247 1.7615744385193106147 1.4889922924497525081;-0.092225143012822724531 -0.74740474081040375598 0.64917542655862470191 0.094925465630865027422 -0.41042528156955088159 0.38776851442821208549 0.34748952149929934752 -0.035169195354581905821 1.0866738649261460381 -1.2982620321533588914;-1.8996341067340121178 0.72882478198498501509 -2.220709544352216458 -0.24038888721070655885 -0.65667188815524935031 -2.3999769234721233246 -1.0460918556675771196 -1.2929677079675727658 -1.3032200499837283125 -1.1295207230882513549;1.6063215824895122896 1.1164899610322873702 0.6097496460498937898 -0.56530150530648248797 -1.1934161590217311488 -2.1237622340887840622 -0.93346624114581788767 -0.14212545648056565395 -0.75852413673107710324 0.86174199536057705107];

% Layer 4
b4 = [2.5233979654936988801;1.0103980987487759524;-1.6678548800854726686;-0.5400822549849122467;-0.6512774396988583181;0.81985077104937853498;-1.2926856764286382973;-3.2506103465242834893;1.2023268330420628924;-1.3974380713926761732];
LW4_3 = [1.2175251373375135522 -0.40405107863414319036 0.42249529260658963414 0.94944246507629936893 -2.0282531078584238315 -0.84460401041831856261 0.41031390619614993565 -0.23382209391187042113 -0.35152060858727740555 0.62963677080657554086;0.32515383666450509148 0.22871574743348446757 0.30695182275218346746 -0.26093701228315052676 -0.97905370871070973582 -0.57394452560294972887 0.19628793670875205324 0.16267197616824496942 -0.40484084848200985185 0.49894144646318400182;1.8832987084606309658 1.3690690937450340492 0.55993553485512803647 -0.15383085381983252482 -1.4155086054252519201 1.7110293109465177785 -0.42932045321886724842 0.27544444768563769443 -0.76075147642146501159 0.15567201458438886807;0.23363287752982633827 -0.50236875193247976235 0.27352086837165112687 1.8150061077504555662 1.8565615218244972962 -0.80752656171225167814 0.46044992546261465094 0.67150733467697487633 1.4543947896697118072 0.37580047679944877936;2.4793747525533968989 0.20889344406202492443 -0.98920799601750630803 -1.1379885488431642493 -1.4170314885762349544 0.81371115940511873355 -1.6717975378274090303 -0.94376256792327928302 0.61231422959579595577 -0.63037018157811297581;0.88388227562389609648 1.9449947036655226285 1.1811748992087012233 1.7271049559587978717 -3.7313210409308412707 -1.7580753429254531994 0.64336194484930675497 -1.3924181204684680235 1.3398642699547087531 -0.89576234873542770476;-0.082343564567229091122 0.29857682260701962074 0.67596405030466799602 -1.3436464872276141502 6.1516024887491616013 -1.6617049215141745933 0.63463448377105102782 0.45081377666063598975 -0.73007869173422534903 -3.9772425426419268923;-0.45205366030237464914 -0.24098622145582085374 0.17621439741748487484 0.74467414632919548545 0.038817412118597460768 -1.2186355981956491501 -3.4571255474586912726 0.22696959864615259828 0.030949052120367477603 -0.17331992427170270221;0.76607934995672155587 0.21738859057392143082 1.3204166922038367282 -1.4529552744457412405 -0.560091662870191076 0.62792994825964887351 -0.88747187457191445414 1.1258197770178406394 1.1201116223515974468 -1.5967782512950794427;-0.54225764497346673476 -1.2455710957546510809 0.60498122709434454247 -0.39298072501051783956 -0.82785281025206503003 1.4864962564171191328 -0.52843970266698214733 0.39919132638394405621 0.22483134377253258251 -0.64440784466193379298];

% Layer 5
b5 = [2.2641718747895973607;-2.3351614046528581525;1.3030818429148098847;-0.59586201921803128023;0.70509661681391655463;0.64402612100980993759;0.54058242804149847505;0.97735202797953313336;-2.7727588029280392234;-0.079973712237751501397];
LW5_4 = [-0.67017253600759596477 -0.34374825353648935655 -0.63118496359392706196 -1.118434917893511793 -0.34961787548788886282 0.058624495757779393479 0.85076413831049702008 -0.74078601411319033865 0.42160743885961060595 -0.68554441941927024562;0.30952263267953561421 -1.080259363054892674 -0.0010417290696964544728 0.7896066042981814137 -0.36122334575679859725 -1.5278905755038212355 -0.1665731350215942097 -1.3088554526896192254 -0.1789301059612653233 -0.021462378650086207793;-0.014295791011641792098 1.193924545709748708 0.41915716184997708904 0.48934478943738851653 -0.88386256259045115069 -0.099274628754897106808 0.10613026244804026066 -0.2384666078960917257 -1.1911136907426016496 1.0193667212758570351;0.42360373822236768726 -0.41898253539980012672 0.860643416515982973 1.6304311003627132148 0.14107857749776112066 -0.44844829130817959184 -0.10060732141261920225 0.81673996266477788541 0.4320770019113840954 0.71414164880207298136;-1.2423396976720662011 -0.7199261092432496234 0.48601222893479356646 -0.34303740556235001735 0.36350633142578631096 0.39273735048915259238 -1.8383154754816082299 0.91838983455911060716 0.1995027625961236506 1.1464060751487052947;-0.98281647382964365534 1.0665454590978766802 -0.087527622760880177677 0.7675374106760843862 0.75527859704376076877 0.30293602809644948337 -1.4193114268414634971 0.1247337194025192747 0.97671902065462024023 0.70472252066676466242;0.45937770026796986844 -0.6620280551255037782 -0.457239910307220776 -0.58539538253479006524 1.0683477684160458399 0.58777867985584619781 0.5603047459908555572 0.26567599643498801543 -0.25234149943964473417 -0.68643195991107830434;0.87597283240315804154 0.42563903672479624918 0.31747782115518197177 -0.84103672975559740088 -0.45123489429790258898 0.84708228400399476765 -0.64008244540095149411 0.20489871167782580663 -0.69765043255907399633 -0.39863501983016003116;-0.53111943830313090853 -0.40604931479969275099 -1.338843859818263704 0.15753143103317018836 -0.50806729065624511854 0.053511356864369218067 -1.7870043401302386776 0.36963287508805664494 -0.075012187087748649628 0.040022208244835627555;2.1556108464611947184 0.26881851572404236173 0.73079652416190610253 -0.66532218963717748572 -0.71975693491781933542 0.62709029153282924707 2.006186919553328174 0.41586977015529535961 0.085137910635876473675 1.6214016674517424121];

% Layer 6
b6 = 0.48868668819244204249;
LW6_5 = [-2.2732483205372107093 -0.8821417941630746995 0.89824629593760507706 -0.77185220125762155075 2.2527588380670882096 -1.3828986988631220001 -0.12433914310670864112 -0.4952650257381960297 -1.5882907807588446669 -0.8564639799258672026];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = tansig_apply(repmat(b4,1,Q) + LW4_3*a3);
    
    % Layer 5
    a5 = tansig_apply(repmat(b5,1,Q) + LW5_4*a4);
    
    % Layer 6
    a6 = repmat(b6,1,Q) + LW6_5*a5;
    
    % Output 1
    Y{1,ts} = a6;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(6,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end
