function [Y,Xf,Af] = ApproxMPC_Aug(X,~,~)
%APPROXMPC_AUG neural network simulation function.
%
% Auto-generated by MATLAB, 15-Sep-2021 20:11:07.
% 
% [Y] = ApproxMPC_Aug(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 2xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;-5];
x1_step1.gain = [0.318309886183791;0.2];
x1_step1.ymin = -1;

% Layer 1
b1 = [4.173077654472396425;-1.8869846286598705998;1.7407171946434902843;0.49639366110364591123;1.4302392476877832106;0.39807178383059838023;-0.21424531934018981039;1.1563729265890263509;2.3836058025475646005;-3.8044372789277347557];
IW1_1 = [-5.202750527044631923 -0.16779304530127697737;4.0193560114616229129 -0.31293008694073326525;-5.0767055390751671951 -0.041083979945817201973;-3.2126300038394237646 1.34247260789383005;-1.4434121402692721148 -0.41561849210400253485;1.2944322720475114341 -1.0282024180481874609;-3.1020740707717040507 -0.70881741748401061454;2.1879161999680882822 0.45280969326096515148;1.5222409908952350133 -1.2505779658369196028;-4.0916127314469390441 1.5100089961437672681];

% Layer 2
b2 = [1.7097735853874398426;1.3949499509694041066;1.3238176296787622643;-0.79521283815950227769;-0.83077804482274142384;1.1694517563665780546;-0.62655653489957652269;0.50468779738072544472;-1.7352341790672189958;-1.6386712944391303992];
LW2_1 = [-0.34752219279332341451 -1.6277230297486349198 0.99461435167168554816 0.43216109723023271583 0.31071458503280263708 0.76845074543623859142 -0.46310796361112255282 0.44947665750903242898 -0.15600534060875539955 -0.095871699422093586973;-0.77667149760971621042 0.46430998121552730096 0.76177462949490237776 -0.25554128706810358418 -0.78153620468270168509 -0.040048205138580261764 -1.1415261744047122683 1.154767126795473553 -0.075255600009620435276 -0.36554978387702491416;-0.14185295860853230909 -0.29692534374169632372 -0.70145687632822872892 0.24692751635028131751 -1.5193327787786454763 0.63837228270271284547 -0.8679933453857672232 0.026216190885804915855 -1.1294858139690222565 0.051136423393315234842;0.90233634684950281279 1.1235759093028629962 -1.2450663549617275727 0.95723336119036495084 0.060725710504676205792 -0.067556520247941689861 1.2588220439740880341 -1.1237004267022916437 -0.71171950167122599584 0.31464643392613744766;2.1914470068950202553 0.45263430609828680939 0.038823417663394504951 -0.057980313651911037642 -0.79754809628326484017 -0.47333897651675160834 -1.1279566842520576397 -1.6223224277380685621 -0.30958955032086549197 -0.17190617135648370017;0.81333740343353166935 1.7991710046926967514 -1.0515149989961218857 0.32952470651802995283 1.1238794266225609064 -0.31266331574442962626 -0.34547912083926990423 0.81144298648371226967 -0.34660494613489772897 0.090329500903783763177;-0.44944129293929530045 -0.52377632664643825056 -1.3501688842559880221 -0.066632752546088427903 -0.16955250990206130468 0.015756641233938877 1.1728380684297909919 1.0404632058123357563 0.32070478768742854969 0.1911102224511641301;-0.25986080676463130246 -0.18587826555885139657 0.12337816599337060597 0.4829992522252949394 1.0458852340720761198 -0.59727976292888940169 -0.43731326716006219124 -2.0149871272011168344 -1.0484847564570809464 -0.195909816201350645;0.075185892800033543582 -0.11170787868290869838 0.93382808966123909133 0.32933345156235022122 -1.0490359508200683969 0.67651184517799400897 -1.4158197526506557384 0.49979228040303924629 1.3197096012010505195 0.67667227119443285055;-0.26999475972486769448 -0.77647726561610208584 0.21969853710350797926 -0.077633585587195519384 -0.26207705926638374949 0.034691373925785209953 0.94176362053198825475 -0.58744136045698247539 -0.63264144000094790776 -0.68964797891823348408];

% Layer 3
b3 = [-1.4566089524731498095;-1.9068942939527504521;0.77158730158987542946;-0.83157209688072952769;0.60647316992978728134;-0.29857734877139685548;-0.07586101355793373191;-1.1510434284895425527;1.2964232968323545769;-1.1043830021110718764];
LW3_2 = [-0.049485177289724423255 0.55072716901734086736 2.1270752128151686478 -1.199263448708925317 -1.2345519292177555837 -0.69411011155606150425 1.5166134945469360584 2.019326820718833293 -1.4979207819587712081 -0.59765493432844518651;0.22248148688909916149 1.7954926898200693763 -0.79016118321276729297 -0.74539870840579058875 0.39046551620234082325 -0.37186251059580910372 0.7361919427991584497 -1.116288438029465091 -1.0705328474269981687 0.68296019754005443669;-0.78239807116666526543 -0.34996582519011387724 0.88733910658904235902 -0.15187978723013492721 0.26648608049017358246 -0.0033701565080050416984 -1.1791528306087029065 0.51935174590898280922 -0.23747779016706047073 -0.82931136754863676863;0.62126891627793001671 -0.12597539812196620335 0.14068675143990408416 -0.046858856451617171557 2.0615143904304611411 0.81350451735222550909 0.010170650408895830219 -0.69004759641769553014 1.3858244028065975773 -0.048166005598137447141;0.34937700055397080678 -0.20776040066443432486 0.71974639813683349843 0.37003726500291073132 1.2407615635440223389 -0.45956838570794444898 -0.32922945366614603246 -1.6794370186510834131 -1.8370155141183570624 -0.80322119626680232862;-0.70557864807333248169 -0.56655794228861089401 0.69795979052534284914 0.7145970680645474804 0.99521718239090195546 -0.095883063488718930922 -0.57579023250443028825 1.0318252928690712089 0.50401440076356385234 -0.11478887967380674295;0.71369921631549992913 -0.0030400625620140772631 0.78344372045802812554 -0.42300175108921234113 -0.42857990036025989111 -0.77438942398674071033 0.93588317428358314132 0.91102832257033961039 0.1352433238229499568 -0.10949790782548793344;-0.48818665342541250896 0.18197460480719787612 1.1592483974385778822 0.51605355256023921484 0.26226172018514082307 0.85632121572587693858 -0.49092523472469756785 0.94926784612173586986 0.37202923252695341283 -1.1091323073097305585;0.8885768105222334734 0.37975132127261335135 -0.34445057300201636918 -0.85893838172298642153 0.68225688977399268076 -0.76682948495846325887 0.67809857888810942672 0.23283572644830691223 -0.27601772016299475077 0.0075935921941020631185;-0.30056188286746426952 -1.1916368220415638479 0.93763776525868069989 -0.39380158143281956962 -0.064140012304846352742 -0.14082651470418602879 -0.63616717557576385467 -0.82357526726591800958 -1.0419756764197480869 0.045659362560397993847];

% Layer 4
b4 = [1.8775871049581704941;1.4822100684143690863;-1.2450528065534656186;-0.32056284331730927617;-0.12313862584786791632;0.43465407783603815517;-0.601185545465277138;0.56262884812949132129;1.316883566261792593;1.7396061537189304591];
LW4_3 = [0.3584161820850034208 -0.27957697737660347492 -0.41451565862354156078 -0.18452215095548996082 1.6702674890508024674 1.2801250231770444632 -1.7109997290822120952 -0.11436787357881166016 -0.60070312724010688221 0.4027547329127152409;-0.18687607389135463265 0.15361917091415736025 0.60649461244042623953 0.16044447028545924527 -1.0747723984856918378 0.39869764904508619985 0.15380486617050112552 1.0954848091285103173 -0.11989245149978088045 -0.90209865026247737507;1.2883031585949056286 1.0876994959126082829 -1.2682698166491022107 -0.5589922505704963962 0.019667069208277886821 0.46717446992338679257 -0.38153304996181958142 0.16274075436660023763 0.87715717578941376775 -0.36277364738828865587;-0.38608574612848639562 0.034096963167263211192 -0.18191418947426996056 0.35990021585861170506 -1.9933333493481375509 -1.1564818171874662323 1.4350939733082022087 0.29605618597182575824 -0.11277695816318514255 -0.22755339103163324532;1.1309228744417163526 0.0050930057606982355803 -0.3169023715120439233 -0.32445723536268283871 -0.35988425811469132443 0.16143542233437271904 -0.90676446377514208219 0.94989953845476771122 -0.18125493503686668229 0.93952409629680988523;-1.099989641340066715 1.8207540559931221225 0.75727910152310173864 0.92796635084610501476 0.42694341507018390702 0.75654839611028401603 1.0719772499218531703 0.67852657306678321181 0.56625455121124368407 -0.43477061026998309323;-0.29127668888003510617 -0.18238549982894419754 0.65547996311093958965 1.0982636625087689453 0.75676669654592410019 -0.78930127645397052394 -0.98603346328053642633 0.21777028580119300871 0.25350093309547971909 0.33699795539600740923;0.42019876280110823874 0.31846355994399005995 0.64271523314724376963 0.1233175427330322621 -0.71693927669484536214 -0.19031425094742351889 0.41197028642653149566 0.90881057385747521238 -0.06281193828992882866 -0.53288291466091874948;0.57157431812270387272 -0.41472425996904088707 -0.44855189541769646677 -0.56977735230546278089 -1.1255244302570039938 0.3897306751764278987 -0.52836961744567001453 -0.30617124013831209517 0.79488678783717703347 -0.8482385592837965449;2.0102574126353083273 -1.203173428461086214 -0.33948286827997325998 -0.93738241787461629162 -0.06838411568898974946 -1.7815906233520242274 -0.22271698476220064267 0.021227870047452166574 -0.36189260786703453254 0.82317666700418246073];

% Layer 5
b5 = [1.5820662941206564689;0.80392313943782678365;0.93731754293718483328;-0.67128398168037839433;0.23235044881724997712;-0.18319335798070612853;-0.62544346300552455808;1.3473023937775090442;-1.0779768013555672823;1.6654814601004426233];
LW5_4 = [-1.180473647854504593 -0.1828256147527486386 -0.39490697153252818374 -0.7000698823117401659 -0.094002819992124869719 -0.95726602236661206824 1.0991614758583987399 0.014284477439283727734 -1.3179153551072901873 0.84992455277907119626;-0.20423157981133516214 0.57153273613060517899 -0.75753529134313002391 0.32316825954306271917 0.99355461844296155682 -0.20320290731766260661 -0.13522365898926325123 0.42772070209271051411 0.44934648535958038318 0.13760649857455137246;-0.41668491529075030178 -0.30700260676265578308 -0.53338478832908686744 0.39581300445778327957 -1.087506100376293805 0.87971491570975912655 0.21410710016017359125 0.30538904743162220701 0.58878233374124400168 0.56586594513237942206;0.51336211421372179853 -0.49958956479782501425 0.24312240092907419498 -0.16209003419466000429 -0.10425907010566629052 -1.3265662948505994034 1.0887051874392088546 -0.72071116265081591745 0.0075411444921511267686 -0.77916019934876057373;-0.8940209779635618359 -0.088338290210363948352 -0.91024473997577315387 -0.67657949535321570966 -0.063030949078970735511 0.74904511355213354573 1.6710614553724654208 1.1578674566586355521 0.1479081376058943853 0.84267171257202011514;0.029312469914221272321 -0.96311080244368330039 0.055796681010791646105 0.40743511957262290579 0.79626537307818756606 0.42137276587336786049 0.66234127239278817179 -1.0539107328557422161 -0.85743965853350356809 -0.95682687569976654363;-1.0312605641270922163 -0.11878956797041907711 0.73524322072234093994 0.38817395257369419204 0.82875353345280722284 -0.13485518182624278705 0.2163367137974082921 0.043089798244749774603 -0.71412987961344254195 1.440435054162562345;-0.78828241009889321589 1.1332738336818841685 1.0117864062845847162 1.5295238571256835058 0.029312694205167376393 0.47397693121466233368 0.17266380344063322894 -0.46722913412060029792 0.36123162275592607395 1.1226900370847578969;-1.0254999492678096296 1.4562266502265344137 -0.13749876273100677948 -0.66257997218507136417 0.88601772464339212387 0.1474238396587932709 0.2339514415632347466 0.23776062531768624164 0.0075916527663936550843 0.3283959693522767731;1.0427608651272128881 0.18902079765251370014 0.56150826127938169297 1.201925317703397722 0.17638610307666849342 -0.96913850846623017521 0.9475536705032188145 -0.29703231054368867126 0.43515608651904441606 0.53509662830846616011];

% Layer 6
b6 = 0.78822191857435874862;
LW6_5 = [0.81296128160614011815 -0.70378776647750218576 0.55950693893487690733 0.143427536635248154 -1.5982361049183002599 0.91272828474834044599 1.0627912373345811403 0.27362077617726976442 -0.76632705908098130987 1.0548035122520056373];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0193782208553811;
y1_step1.xoffset = -51.6043246426542;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = tansig_apply(repmat(b4,1,Q) + LW4_3*a3);
    
    % Layer 5
    a5 = tansig_apply(repmat(b5,1,Q) + LW5_4*a4);
    
    % Layer 6
    a6 = repmat(b6,1,Q) + LW6_5*a5;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a6,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(6,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
